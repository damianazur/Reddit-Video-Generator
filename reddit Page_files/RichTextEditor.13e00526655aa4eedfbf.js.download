(window.webpackJsonp=window.webpackJsonp||[]).push([["RichTextEditor"],{"./src/lib/isSimpleClick/index.ts":function(e,t,n){"use strict";t.a=(e=>{if(e&&e.target&&(e=>{let t=e;for(;t&&t!==window.document.body;){if("A"===t.nodeName)return!0;t=t.parentElement}return!1})(e.target)){if(e.ctrlKey)return!1;if(e.altKey)return!1;if(e.metaKey)return!1;if(e.shiftKey)return!1}return!0})},"./src/lib/linkMatchers/index.ts":function(e,t,n){"use strict";var o=n("./node_modules/linkify-it/index.js"),s=n.n(o),r=n("./node_modules/tlds/index.js"),i=n.n(r),a=n("./src/lib/linkMatchers/customLinks.ts"),d=n("./node_modules/lodash/values.js"),c=n.n(d);const l=e=>c()(a.b).includes(e.substring(1)),m=["//","ftp:","http:","https:","mailto:"],u=e=>((e,t)=>(t.forEach(t=>e.add(t,null)),e))(e,m);n.d(t,"c",function(){return p}),n.d(t,"d",function(){return b}),n.d(t,"g",function(){return f}),n.d(t,"a",function(){return C}),n.d(t,"b",function(){return E}),n.d(t,"e",function(){return w}),n.d(t,"f",function(){return y});const p=s()().tlds(i.a).set({fuzzyIP:!0}),h=s()().set({fuzzyIP:!0}).add(a.f.mention.prefix,a.f.mention.config),b=u(s()()).set({fuzzyLink:!1,fuzzyEmail:!1}).add(a.f.subreddit.prefix,a.f.subreddit.config).add(a.f.subredditFull.prefix,a.f.subreddit.config),f=u(s()()).set({fuzzyLink:!1,fuzzyEmail:!1}).add(a.f.profile.prefix,a.f.profile.config).add(a.f.profileFull.prefix,a.f.profile.config),g=s()().tlds(i.a).set({fuzzyIP:!0}).add(a.f.subreddit.prefix,a.f.subreddit.config).add(a.f.subredditFull.prefix,a.f.subreddit.config).add(a.f.profile.prefix,a.f.profile.config).add(a.f.profileFull.prefix,a.f.profile.config).add(a.f.mention.prefix,a.f.mention.config),x=p.normalize;p.normalize=(e=>{x.call(p,e),!e.schema&&e.url.startsWith("http:")&&(e.url=`https:${e.url.slice(5)}`)});const C=(e,t)=>{return(g.match(e)||[]).filter(e=>{const n=l(e.text);return!n||n&&t})},E=e=>{return[...f.match(e)||[],...h.match(e)||[]].map(e=>!l(e.text)&&e.text.replace(a.a,"")).filter(e=>e)},w=(e,t)=>{const n=e.match(t);if(n&&1===n.length&&0===n[0].index&&n[0].lastIndex===t.length)return n[0]},y=e=>{const t=p.match(e);if(t&&1===t.length&&0===t[0].index){const n=t[0];return n.lastIndex===e.length?n:((e,t)=>{const n=e.substring(t.lastIndex);if(/.*\/\/.*\/.*/.test(t.url)&&/^(\?|\!)+$/.test(n))return t.lastIndex+=n.length,t.url+=n,t})(e,n)}}},"./src/reddit/actions/economics/subredditPremium/actionCreators.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return m}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return p});var o=n("./src/lib/makeActionCreator/index.ts"),s=n("./src/reddit/actions/economics/subredditPremium/constants.ts");const r=Object(o.a)(s.a),i=Object(o.a)(s.b),a=Object(o.a)(s.c),d=Object(o.a)(s.d),c=(Object(o.a)(s.e),Object(o.a)(s.f)),l=Object(o.a)(s.g),m=Object(o.a)(s.h),u=Object(o.a)(s.i),p=Object(o.a)(s.j)},"./src/reddit/actions/economics/subredditPremium/thunkedActions.ts":function(e,t,n){"use strict";var o=n("./src/reddit/actions/governance/errorToast.ts"),s=n("./src/reddit/endpoints/economics/specialMembership.ts"),r=n("./node_modules/lodash/merge.js"),i=n.n(r),a=n("./src/reddit/endpoints/governance/badges.ts"),d=n("./src/reddit/endpoints/governance/community.ts"),c=n("./src/reddit/endpoints/governance/products/badges.ts"),l=n("./src/config.ts"),m=n("./src/reddit/endpoints/governance/requester.ts");var u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,s=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(o=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(d){s=!0,r=d}finally{try{!o&&a.return&&a.return()}finally{if(s)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();async function p(e,t,n){const o={subredditId:t,badges:{},errors:{},collections:{},products:{},subscription:void 0,userOwnedBadges:[]},s=function(e,t){return Object(m.a)(e,{method:"get",endpoint:`${l.a.metaUrl}/product-collections/${t}?types=badge`})}(e,t),r=Object(d.a)(e,{subredditId:t}),p=Object(c.a)(e,t),h=Object(a.c)(e,t,n);var b=await Promise.all([s,r,p,h]),f=u(b,4);const g=f[0],x=f[1],C=f[2],E=f[3];if(g.ok?o.collections=g.body:o.errors.collections=g.error,x.ok){const e=x.body.specialMemberships;o.subscription=e}return C.ok?o.products=C.body:o.errors.products=C.error,E.ok?(i()(o.badges,E.body.badges),o.userOwnedBadges=E.body.userOwnedBadges):o.errors.userBadges=E.error,o}var h=n("./src/reddit/models/Badge/index.ts"),b=n("./src/reddit/models/Badge/managementPage.ts"),f=n("./src/reddit/reducers/economics/subredditPremium/index.ts"),g=n("./src/reddit/selectors/economics.ts"),x=n("./src/reddit/actions/economics/subredditPremium/actionCreators.ts");n.d(t,"a",function(){return C}),n.d(t,"d",function(){return E}),n.d(t,"b",function(){return w}),n.d(t,"c",function(){return y});const C=()=>async(e,t,{apiContext:n})=>{const o=t().user.account,r=!t().economics.specialMemberships.allSubscriptionsFetched;if(o&&r){const t=await Object(s.b)(n());if(t.ok){e(Object(x.a)(t.body));const o=Object.keys(t.body);if(o.length){const t=await Object(s.e)(n(),o);t.ok&&e(Object(x.g)(t.body))}}}},E=(e,t)=>async(n,o,{apiContext:s})=>{const r=o().user.account,i=o().economics.subredditPremium[e],a=!i||i.status!==f.a.Fetched||t;if(r&&a){const t=await p(s(),e,r.id);n(Object(x.i)(t))}},w=e=>async(t,n,{apiContext:s})=>{const r=n(),i=r.user.account,d=Object(g.d)(r,e.subredditId),c=Object.keys(d).map(e=>d[e]).filter(Boolean);if(i&&e.badge){let n;n=e.placement===h.a.First?d[b.a.Loyalty]:e.placement===h.a.Second?d[b.a.Achievement]:d[b.a.Cosmetic],t(Object(x.b)(Object.assign({},e,{currentAppliedBadges:c,userId:i.id})));const r=await Object(a.a)(s(),e.subredditId,e.badge.id);r.ok||(t(Object(x.b)(Object.assign({},e,{badge:n,currentAppliedBadges:c,userId:i.id}))),Object(o.a)(t,r.error))}},y=e=>async(t,n,{apiContext:s})=>{const r=n().user.account,i=!n().economics.emotes[e];if(r&&i){const n=await function(e,t){return Object(m.a)(e,{method:"get",endpoint:`${l.a.metaUrl}/products/${t}?types=emotes-pack`})}(s(),e);n.ok?t(Object(x.e)({subredditId:e,packs:n.body})):Object(o.a)(t,n.error)}}},"./src/reddit/components/CollapseIntoOverflow/index.m.less":function(e,t,n){e.exports={hidden:"_2x_bJPl7Q970NCRxOS36QB",innerWrapper:"_3oLr47tuKGv2mNpavCZ2X0",outerWrapper:"_1wi_3uF8fUynqe5reIop-G",overflowMenu:"_2aOuodBenLHlceR3j0AlIM",overflowMenuWrapper:"_3nQ7w1VIzZvzFawddOYgBC",row:"_2IirhjIkZ7hgWGtpr087xZ"}},"./src/reddit/components/CommentCreation/ExpandingFormDiv.tsx":function(e,t,n){"use strict";var o=n("./bundled-modules/styled-components/styled-components.min.js");const s=n.n(o).a.div.withConfig({componentId:"jvfwx7-0"})(["",""],e=>e.breakOut?`\n        background-color: white;\n        left: -${((e,t)=>21*e+33+(t?10:0))(e.depth,e.isEditing)}px;\n        margin: -16px;\n        padding: 16px;\n        position: absolute;\n        right: 0;\n        z-index: 2;\n      `:"");t.a=s},"./src/reddit/components/CommentCreation/FormFooter/index.m.less":function(e,t,n){e.exports={SubmitButton:"_22S4OsoDdOqiM-hPTeOURa",submitButton:"_22S4OsoDdOqiM-hPTeOURa",LoadingIcon:"_2qsMO_C_HwxgUgktaOeqZ2",loadingIcon:"_2qsMO_C_HwxgUgktaOeqZ2",CancelButton:"cZz52cPDbNgzrR1Oo1k27",cancelButton:"cZz52cPDbNgzrR1Oo1k27",ButtonWrapper:"_3SNMf5ZJL_5F1qxcZkD0Cp",buttonWrapper:"_3SNMf5ZJL_5F1qxcZkD0Cp"}},"./src/reddit/components/CommentCreation/FormFooter/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./bundled-modules/styled-components/styled-components.min.js"),i=n.n(r),a=n("./src/reddit/constants/componentSizes.ts"),d=n("./src/reddit/controls/Button/index.tsx"),c=n("./src/reddit/controls/LoadingIcon/index.tsx"),l=n("./src/reddit/helpers/styles/components/index.tsx"),m=n("./src/reddit/i18n/components.tsx"),u=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),p=n("./src/reddit/components/CommentCreation/FormFooter/index.m.less"),h=n.n(p),b=n("./src/lib/lessComponent.tsx");const f=i()(Object(l.a)()).withConfig({componentId:"s16qjpwc-0"})(["position: sticky;bottom: 0;z-index: 1;opacity: ",";background-color: ",";display: flex;flex-direction: row-reverse;align-items: center;height: ","px;border-radius: 0px 0px 4px 4px;"],e=>e.pending?"0.5":"1",e=>Object(u.c)(e).field,a.C),g=b.a.wrapped(d.f,"SubmitButton",h.a),x=b.a.wrapped(c.a,"LoadingIcon",h.a),C=b.a.wrapped(d.i,"CancelButton",h.a),E=b.a.div("ButtonWrapper",h.a),w=e=>e.preventDefault();t.a=(({pending:e,cancelButtonEnabled:t=!0,children:n,className:o,submitButtonText:r,canSubmit:i,onSubmit:a,onCancel:d})=>s.a.createElement(f,{pending:e,className:o},s.a.createElement(E,null,s.a.createElement(g,{type:"submit",disabled:!i,onClick:a,onMouseDown:w},e?s.a.createElement(x,{sizePx:10}):r),t&&s.a.createElement(C,{type:"reset",disabled:e,onClick:d,onMouseDown:w},s.a.createElement(m.c,null,"cancel"))),n))},"./src/reddit/components/CommentCreation/MarkdownCommentForm/MarkdownModeButton.m.less":function(e,t,n){e.exports={LoadingIcon:"_2DZnviMjaD88Udr-5V3j38",loadingIcon:"_2DZnviMjaD88Udr-5V3j38",Wrapper:"_3oZ5XBWSc3x7cXsvdt3fJ",wrapper:"_3oZ5XBWSc3x7cXsvdt3fJ",MarkdownModeIcon:"_1EifMLRAKpii4eqciAhY4q",markdownModeIcon:"_1EifMLRAKpii4eqciAhY4q",Button:"_1Q2Vq3gesOWZA73NbspEiQ",button:"_1Q2Vq3gesOWZA73NbspEiQ"}},"./src/reddit/components/CommentCreation/MarkdownCommentForm/index.m.less":function(e,t,n){e.exports={LoadingIcon:"_2izw1tRcQRvnfuR1E05Cy4",loadingIcon:"_2izw1tRcQRvnfuR1E05Cy4",CommentHeader:"PN-j_b1WdWATQha3fOgkV",commentHeader:"PN-j_b1WdWATQha3fOgkV",HelpButton:"MQruKnjMvMoDlmee_nF40",helpButton:"MQruKnjMvMoDlmee_nF40"}},"./src/reddit/components/CommentCreation/MarkdownCommentForm/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-dom/index.js"),i=n("./node_modules/react-redux/es/index.js"),a=n("./node_modules/react-router-dom/es/index.js"),d=n("./node_modules/reselect/es/index.js"),c=n("./bundled-modules/styled-components/styled-components.min.js"),l=n.n(c),m=n("./src/app/strings/index.ts"),u=n("./src/reddit/components/AuthorLink/index.tsx"),p=n("./src/reddit/components/ConfirmUserActionModal/index.tsx"),h=n("./src/reddit/components/MarkdownHelp/index.tsx"),b=n("./src/reddit/controls/ErrorText/index.tsx"),f=n("./src/reddit/controls/LoadingIcon/index.tsx"),g=n("./src/reddit/i18n/utils.ts"),x=n("./src/reddit/icons/svgs/Help/index.tsx"),C=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),E=n("./src/reddit/components/CommentCreation/ExpandingFormDiv.tsx"),w=n("./src/reddit/components/CommentCreation/FormFooter/index.tsx"),y=n("./src/lib/fastdom/index.ts"),v=n("./src/reddit/components/CommentCreation/ToolbarSelector.m.less"),j=n.n(v),O=n("./src/lib/lessComponent.tsx");const T=310,k=O.a.div("Container",j.a);class R extends s.a.Component{constructor(){super(...arguments),this.state={toolbarType:null},this.setContainerRef=(e=>this.container=e),this.selectToolbar=(()=>{const e=this.container&&this.container.parentElement;if(!e)return;const t=e.getBoundingClientRect().width<T?"compact":"full";t!==this.state.toolbarType&&y.a.write(()=>{this.setState({toolbarType:t})})})}componentDidMount(){y.a.read(this.selectToolbar),window.addEventListener("resize",this.selectToolbar)}componentWillUnmount(){window.removeEventListener("resize",this.selectToolbar)}render(){return s.a.createElement(k,{innerRef:this.setContainerRef},this.state.toolbarType?this.props.children(this.state.toolbarType):null)}}var M=e=>s.a.createElement("svg",{className:e.className,viewBox:"0 0 208 128"},s.a.createElement("rect",{width:"198",height:"118",x:"5",y:"5",ry:"10",stroke:"currentColor",strokeWidth:"10",fill:"none"}),s.a.createElement("path",{d:"M30 98v-68h20l20 25 20-25h20v68h-20v-39l-20 25-20-25v39zM155 98l-30-33h20v-35h20v35h20z"})),S=n("./src/reddit/components/PostCreationForm/DivButton/index.tsx"),I=n("./src/reddit/components/RichTextEditor/HoverTooltip/index.tsx"),B=n("./src/reddit/components/CommentCreation/MarkdownCommentForm/MarkdownModeButton.m.less"),_=n.n(B);const F=Object(m.e)("comment.switchToRTE"),P=O.a.wrapped(f.a,"LoadingIcon",_.a),D=O.a.div("Wrapper",_.a),N=O.a.wrapped(M,"MarkdownModeIcon",_.a),A=O.a.wrapped(S.a,"Button",_.a);var H=e=>{const t=F(e.language);return s.a.createElement(D,null,s.a.createElement(A,{"aria-label":t,setRef:e.buttonRef,className:e.className,onClick:e.onClick},e.isConverting&&s.a.createElement(P,{sizePx:12}),s.a.createElement(I.b,{text:t}),!e.isConverting&&s.a.createElement(N,null)))},z=n("./src/reddit/constants/keycodes.ts"),W=n("./src/reddit/components/CommentCreation/getCancelModalId.ts"),L=n("./src/reddit/components/CommentCreation/translations.ts"),K=n("./src/reddit/constants/componentSizes.ts"),q=n("./src/reddit/constants/componentTestIds.ts"),U=n("./src/reddit/helpers/styles/components/index.tsx"),V=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),X=n("./src/reddit/selectors/activeModalId.ts"),J=n("./src/reddit/selectors/comments.ts"),Q=n("./src/reddit/selectors/editorContent.ts"),$=n("./src/reddit/components/CommentCreation/NavigationModule/index.ts"),Z=n("./src/reddit/actions/modal.ts"),Y=n("./src/reddit/components/ResizableAutosizeTextarea/index.tsx"),G=n("./src/reddit/models/PostCreationForm/index.ts"),ee=n("./src/reddit/models/PostDraft/index.ts"),te=n("./src/reddit/models/User/index.ts"),ne=n("./src/reddit/components/CommentCreation/MarkdownCommentForm/index.m.less"),oe=n.n(ne);n.d(t,"a",function(){return le});const se=l.a.button.withConfig({componentId:"s5gmist-0"})(["","color: ",";margin-left: 8px;width: auto;display: flex;"],V.bodyFontSmall,e=>Object(C.c)(e).linkText),re=O.a.wrapped(f.a,"LoadingIcon",oe.a),ie=O.a.div("CommentHeader",oe.a),ae=l.a.span.withConfig({componentId:"s5gmist-1"})(["","color: ",";margin-right: 4px;"],V.bodyFontSmall,e=>Object(C.c)(e).bodyText),de=O.a.button("HelpButton",oe.a),ce=l()(x.a).withConfig({componentId:"s5gmist-2"})(["fill: ",";width: 12px;height: 12px;"],e=>Object(C.c)(e).actionIcon),le=e=>s.a.createElement(de,{className:e.className,onClick:e.onClick},s.a.createElement(ce,null)),me=8,ue=16,pe=l()(Object(U.a)()).withConfig({componentId:"s5gmist-3"})(["position: relative;margin: ",";",""],e=>e.isTopLevelComment?"24px 40px":"16px 0 16px 22px",e=>e.height?`height: ${e.height}px;`:""),he=l.a.div.withConfig({componentId:"s5gmist-4"})(["border: ",";border-radius: 4px;background: ",";"],e=>e.pending?"1px solid rgba(0,0,0,0.05)":e.focused?"1px solid #1A1A1B":"1px solid #878A8C",e=>Object(C.c)(e).body),be=Object(i.b)(()=>Object(d.c)({activeModalId:X.a,userName:e=>e.user.account?Object(te.f)(e.user.account):"",pending:(e,t)=>e.comments.submit.pending[t.draftKey],draft:J.j,isConverting:(e,t)=>Object(Q.a)(e,t.draftKey)}),(e,t)=>({cancelModalToggled:()=>e(Object(Z.i)(Object(W.a)(t.draftKey))),helpModalToggled:()=>e(Object(Z.i)(h.b))}));t.b=be(Object(a.f)(class extends s.a.Component{constructor(e){super(e),this.textAreaRef=null,this.cancelForm=(()=>{this.props.onCancel(),this.onBlur()}),this.detectBreakout=(()=>{if(!this.wrapperEl||!this.wrapperEl.parentElement||this.props.isTopLevelComment)return;const e=this.wrapperEl.parentElement.getBoundingClientRect().width<K.f,t=this.getWrapperHeight();e===this.state.breakOut&&t===this.state.wrapperHeight||y.a.write(()=>{this.setState({breakOut:e,wrapperHeight:t})})}),this.focus=(()=>{this.textAreaRef&&this.textAreaRef.focus()}),this.onChange=(e=>{const t=e.currentTarget.value;this.props.onChange&&this.props.onChange({text:t,editorState:null}),this.setState(()=>({text:t,hasChanged:!0,showError:!1}),()=>{y.a.read(this.detectBreakout)})}),this.shouldConfirmCancel=(()=>this.userHasEnteredText()&&this.state.hasChanged&&this.props.draftType===ee.c.edit),this.onCancel=(()=>{this.shouldConfirmCancel()?this.props.cancelModalToggled():this.cancelForm()}),this.onBlur=(e=>{(!e||e&&e.relatedTarget!==this.switchModeBtn)&&(this.textAreaRef&&this.textAreaRef.blur(),this.props.onFocusChanged(!1))}),this.onFocus=(()=>{this.props.onFocus(),this.props.onFocusChanged(!0)}),this.handleKeyDown=(e=>{const t=e.ctrlKey,n=e.metaKey,o=e.keyCode;(t||n)&&o===z.a.Enter&&this.onSubmit()}),this.onSubmit=(()=>{this.props.onSubmit({commentMode:G.h.MARKDOWN,draftType:this.props.draftType,editorState:null,text:this.getCurrentText()}),this.onBlur()}),this.userHasEnteredText=(()=>!!this.state.text.trim()),this.setWrapperRef=(e=>{this.wrapperEl=e,this.props.editorElementRef&&this.props.editorElementRef(e)}),this.setTextAreaRef=(e=>this.textAreaRef=e);const t=e.draftType,n=e.hasError,o=e.initialText,s=e.language;this.state={text:o||"",autofocusDisabled:!1,hasChanged:!1,showError:n,breakOut:!1,wrapperHeight:void 0,formHeight:null,cancelModalText:t===ee.c.edit?Object(m.a)(s,"comment.confirmCancellation.edit"):Object(m.a)(s,"comment.confirmCancellation.creation")}}componentDidMount(){this.props.onMount(),window.addEventListener("resize",this.detectBreakout),y.a.read(this.detectBreakout),y.a.write(()=>{this.props.draft.hasFocus&&this.textAreaRef&&this.textAreaRef.focus()}),this.props.instanceRef&&this.props.instanceRef(this)}componentWillUnmount(){this.props.onUnmount({text:this.getCurrentText()}),window.removeEventListener("resize",this.detectBreakout),this.props.instanceRef&&this.props.instanceRef(null)}componentDidUpdate(e){const t=e.pending;var n=this.props;const o=n.hasError,s=n.pending;!t||s||o?e.hasError!==this.props.hasError&&this.setState({showError:this.props.hasError}):this.setState({text:"",showError:!1})}getCurrentText(){const e=this.props.draft,t=e&&e.text;return this.state.text||t}getWrapperHeight(){if(!this.textAreaRef)return;const e=Object(r.findDOMNode)(this.textAreaRef);return e instanceof Element?e.getBoundingClientRect().height+me+ue+K.C:void 0}render(){var e=this.props;const t=e.activeModalId,n=e.autofocus,o=e.cancelModalToggled,r=e.className,i=e.disableAutofocus,a=e.depth,d=e.draft,c=e.draftKey,l=e.draftType,m=e.errorMsgs,f=e.pending,x=e.language,C=e.submitButtonText,y=e.isTopLevelComment,v=e.onSwitchMode,j=e.userName;var O=this.state;const T=O.cancelModalText,k=O.showError,M=O.text,S=O.breakOut,I=O.wrapperHeight,B=Object(W.a)(c),_=d.draftType===ee.c.edit;return s.a.createElement(pe,{"data-test-id":q.b,className:r,height:S?I:void 0,innerRef:this.setWrapperRef,isTopLevelComment:!!y},y&&s.a.createElement(ie,null,s.a.createElement(ae,null,"Comment as"),s.a.createElement(u.a,{author:j,isAdmin:!1,isAdminEmeritus:!1,isAuthorDeleted:!1,isMod:!1,isOp:!1},j)),s.a.createElement(E.a,{breakOut:S,depth:a,isEditing:_},s.a.createElement(he,{pending:f,focused:d.hasFocus},s.a.createElement(Y.a,{innerRef:this.setTextAreaRef,autoFocus:n&&!i,disabled:f,initialHeight:this.props.initialHeight,onBlur:this.onBlur,onChange:this.onChange,onEditorResize:this.props.onEditorResize,onFocus:this.onFocus,onKeyDown:this.handleKeyDown,placeholder:Object(g.c)("What are your thoughts?"),value:M}),s.a.createElement(w.a,{cancelButtonEnabled:l!==ee.c.replyToPost,onSubmit:this.onSubmit,onCancel:this.onCancel,pending:f,submitButtonText:C,canSubmit:this.userHasEnteredText()},s.a.createElement(R,null,e=>"compact"===e?s.a.createElement(H,{language:x,buttonRef:e=>this.switchModeBtn=e,onClick:()=>v(G.h.RICH_TEXT,M,c),isConverting:this.props.isConverting}):s.a.createElement("div",null,s.a.createElement(se,{innerRef:e=>this.switchModeBtn=e,onClick:()=>v(G.h.RICH_TEXT,M,c)},"Switch to Fancy Pants Editor",this.props.isConverting&&s.a.createElement(re,{sizePx:12})))),s.a.createElement(le,{onClick:this.props.helpModalToggled})))),k&&Object(b.b)(m,x),t===B&&s.a.createElement(p.a,{actionText:Object(L.a)(x),cancelActionText:Object(L.b)(x),modalText:T,onConfirm:()=>this.cancelForm(),toggleModal:o,trackClick:()=>{}}),t===h.b&&s.a.createElement(h.a,{language:x}),s.a.createElement($.a,{language:x,editKey:c,hasValue:!!M}))}}))},"./src/reddit/components/CommentCreation/NavigationModule/index.ts":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-router-dom/es/index.js"),i=n("./src/app/strings/index.ts");let a=null;class d extends s.a.PureComponent{constructor(){super(...arguments),this.unblock=(e=>{d.blockers.delete(e),d.blockers.size||(a&&a(),a=null,window.removeEventListener("beforeunload",d.navigationBlocker))})}componentDidUpdate(e){!e.hasValue&&this.props.hasValue?this.block(this.props.editKey):e.hasValue&&!this.props.hasValue&&this.unblock(this.props.editKey)}componentWillUnmount(){this.unblock(this.props.editKey)}componentDidMount(){this.props.hasValue&&this.block(this.props.editKey)}block(e){d.blockers.add(e),a||(window.addEventListener("beforeunload",d.navigationBlocker),a=this.props.history.block(()=>{const e=this.props.isPostEdit?Object(i.a)(this.props.language,"posts.confirmNavigation"):Object(i.a)(this.props.language,"comment.confirmNavigation");return window.confirm(e)?void 0:"Are you sure you want to leave?"}))}render(){return null}}d.blockers=new Set,d.navigationBlocker=(e=>{const t="Are you sure you want to leave?";return e.returnValue=t,t}),t.a=Object(r.f)(d)},"./src/reddit/components/CommentCreation/RequestToCommentForm/index.m.less":function(e,t,n){e.exports={RequestBox:"_2dVm83ugs7xhdLU8UptoxO",requestBox:"_2dVm83ugs7xhdLU8UptoxO",commentIcon:"_3-cqJ5aJH2EZKxhqY43T9D",commentText:"_2o9LnZvm1HYNaUjzmMO8E5",requestButton:"_3OvdD2phTivi0gnXR8NPl-"}},"./src/reddit/components/CommentCreation/RichtextCommentForm/index.m.less":function(e,t,n){e.exports={CommentHeader:"_2kZkQ13N-kvhDEJOBd1S1I",commentHeader:"_2kZkQ13N-kvhDEJOBd1S1I",FormFooter:"RQTXfVRnnTF5ont3w58rx",formFooter:"RQTXfVRnnTF5ont3w58rx",MarkdownButtonWrapper:"_3SWQgWX2fzvWmGCv463r_-",markdownButtonWrapper:"_3SWQgWX2fzvWmGCv463r_-",SectionSpacer:"_3rYrfakWyDh7Y1L9ULn4ve",sectionSpacer:"_3rYrfakWyDh7Y1L9ULn4ve",ToolbarWrapper:"_2YcMhGs5-uIg9Fj4a9J2Xr",toolbarWrapper:"_2YcMhGs5-uIg9Fj4a9J2Xr"}},"./src/reddit/components/CommentCreation/ToolbarSelector.m.less":function(e,t,n){e.exports={Container:"_1XC-wMQsKPqfaPcfWQCZdW",container:"_1XC-wMQsKPqfaPcfWQCZdW"}},"./src/reddit/components/CommentCreation/getCancelModalId.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return o});const o=e=>`Comment-cancelModal__${e}`},"./src/reddit/components/CommentCreation/index.tsx":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/lodash/once.js"),s=n.n(o),r=n("./node_modules/react/index.js"),i=n.n(r),a=n("./node_modules/react-redux/es/index.js"),d=n("./node_modules/reselect/es/index.js"),c=n("./src/reddit/actions/comment.ts"),l=n("./src/reddit/helpers/trackers/commentsPage.ts"),m=n("./src/reddit/components/CommentCreation/MarkdownCommentForm/index.tsx"),u=n("./src/lib/lessComponent.tsx"),p=n("./src/reddit/components/ContributorRequestFlow/ContributorRequestButton.tsx"),h=n("./src/reddit/i18n/utils.ts"),b=n("./src/reddit/icons/fonts/Comment/index.tsx"),f=n("./src/reddit/models/SubredditRestrictions/index.ts"),g=n("./src/reddit/components/CommentCreation/RequestToCommentForm/index.m.less"),x=n.n(g);const C=u.a.div("RequestBox",x.a);var E=()=>i.a.createElement(C,null,i.a.createElement(b.a,{className:x.a.commentIcon}),i.a.createElement("div",{className:x.a.commentText},Object(h.c)("Only approved users can comment in this community.")),i.a.createElement(p.a,{className:x.a.requestButton,eventSource:f.b.Comment})),w=n("./node_modules/lodash/noop.js"),y=n.n(w),v=n("./bundled-modules/styled-components/styled-components.min.js"),j=n.n(v),O=n("./src/lib/fastdom/index.ts"),T=n("./src/lib/memoizeByReference/index.ts"),k=n("./src/reddit/components/AuthorLink/index.tsx"),R=n("./src/reddit/components/ConfirmUserActionModal/index.tsx"),M=n("./src/reddit/actions/users.ts"),S=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),I=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),B=n("./src/reddit/icons/svgs/Close/index.tsx"),_=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&(n[o[s]]=e[o[s]])}return n};const F=Object(v.keyframes)(["from {opacity: 0;}to {opacity: 1;}"]),P=j.a.div.withConfig({componentId:"gfna1g-0"})(["cursor: pointer;margin-left: 8px;padding-top: 2px;"]),D=j()(B.a).withConfig({componentId:"gfna1g-1"})(["height: 12px;width: 12px;fill: white;"]),N=j.a.div.withConfig({componentId:"gfna1g-2"})(["","animation: "," 0.5s ease-in;background-color: ",";border-radius: 5px;bottom: 100%;color: ",";display: flex;left: 50%;margin-bottom: 5px;padding: 5px 8px;pointer-events: auto;position: absolute;text-align: center;transform: translateX(-50%);white-space: pre;z-index: 99999;&::after {border-left: 5px solid transparent;border-right: 5px solid transparent;border-top: 5px solid ",';content: "";left: 50%;margin-left: -5px;position: absolute;top: 100%;width: 0;}'],S.titleFontH6,F,e=>Object(I.c)(e).button,e=>Object(I.c)(e).lightText,e=>Object(I.c)(e).button);var A=j()(e=>{const t=e.text,n=e.children,o=_(e,["text","children"]);return i.a.createElement("div",Object.assign({},o),t?i.a.createElement(N,null,t,i.a.createElement(P,null,i.a.createElement(D,null))):null,n)}).withConfig({componentId:"gfna1g-3"})(["position: absolute;top: 0;left: 0;right: 0;bottom: 0;"," {transition: opacity 0s 0.5s;}&:hover "," {visibility: visible;opacity: 1;}"],N,N);var H=Object(a.b)(null,e=>({onMarkdownModeFtuUxViewed:()=>e(Object(M.t)({commentForm:{markdownModeNotification:!0}}))}))(class extends i.a.Component{componentDidUpdate(){var e=this.props;const t=e.onMarkdownModeFtuUxViewed;e.shouldShowFtuMessage&&t()}render(){var e=this.props;const t=e.onClick;return e.shouldShowFtuMessage&&i.a.createElement(A,{onClick:t,text:this.props.text})}}),z=n("./src/reddit/components/RichTextEditor/index.tsx"),W=n("./src/reddit/components/RichTextEditor/helpers/controlsState.ts"),L=n("./src/lib/classNames/index.ts"),K=n("./src/reddit/components/OverflowMenu/index.tsx"),q=n("./src/reddit/components/CollapseIntoOverflow/index.m.less"),U=n.n(q);const V=33,X=e=>e.preventDefault(),J=e=>`Comment--Overflow-Dropdown__${e}`,Q=e=>e.reduce((e,t)=>(Array.isArray(t)?e+=t.length:t&&e++,e),0);class $ extends i.a.Component{constructor(e){super(e),this.updateCurrentBreakpoint=(()=>{O.a.read(()=>{var e=this.state;const t=e.indexOfCurrentBreakpoint,n=e.totalNumCollapsibleItems,o=t<n-1,s=t>0,r=this.breakpoints[t],i=this.breakpoints[t+1];if(this.container){let e=this.container.clientWidth;const t=e<=r&&s,a=e>(i||r)&&o;if(t||a){e-=V;const o=t?0:n-1;let s=this.breakpoints.findIndex((t,n)=>e>=t&&e<this.breakpoints[n+1]);s=s>=0?s:o,O.a.write(()=>{this.setState({indexOfCurrentBreakpoint:s,shouldShowOverflow:s<n-1})})}}})});const t=Array.isArray(e.children)?Q(e.children):1;this.state={indexOfCurrentBreakpoint:t-1,shouldShowOverflow:!1,totalNumCollapsibleItems:t},this.breakpoints=[]}componentDidMount(){window.addEventListener("resize",this.updateCurrentBreakpoint)}componentWillUnmount(){window.removeEventListener("resize",this.updateCurrentBreakpoint)}registerBreakpoint(e,t){O.a.read(()=>{if(e&&e.clientWidth){const n=e.clientWidth;this.breakpoints[t]=0===t?n:this.breakpoints[t-1]+n,t===this.state.totalNumCollapsibleItems-1&&this.updateCurrentBreakpoint()}})}render(){var e=this.props;const t=e.children,n=e.className,o=e.oveflowMenuDropdownId,s=e.onOverflowMenuClick,r=e.renderOverflowMenuTooltip;var a=this.state;const d=a.indexOfCurrentBreakpoint,c=a.shouldShowOverflow,l=i.a.Children.toArray(t).filter(Boolean);return i.a.createElement("div",{className:Object(L.a)(U.a.outerWrapper,n),ref:e=>this.container=e},i.a.createElement("div",{className:U.a.innerWrapper},l.map((e,t)=>i.a.createElement("span",{className:t>d?U.a.hidden:void 0,ref:e=>this.registerBreakpoint(e,t)},e)),c&&i.a.createElement("div",{className:U.a.overflowMenuWrapper,key:"overflowMenuWrapper"},r&&r(),i.a.createElement(K.b,{className:U.a.overflowMenu,dropdownId:J(o),isFixed:!1,handleMouseDown:X,onClick:s},i.a.createElement("div",{className:U.a.row},l.map((e,t)=>i.a.createElement("span",{className:t<=d?U.a.hidden:void 0},e)))))))}}var Z=n("./src/reddit/components/RichTextEditor/Toolbar/index.tsx"),Y=n("./src/reddit/icons/svgs/Smile/index.tsx"),G=n("./src/reddit/components/RichTextEditor/Toolbar/FormatterButton/index.tsx"),ee=n("./src/reddit/components/RichTextEditor/Toolbar/formatterConfigs.ts");const te=Object(ee.f)(Y.a);var ne=function(e){const t=e.controlsState,n=e.onEmoteButtonClick;return i.a.createElement(G.a,{Icon:te,tooltip:Object(h.c)("Add Emote"),enabled:t.emote.isEnabled,onClick:n})};const oe=j.a.div.withConfig({componentId:"e7xz0e-0"})(["box-sizing: border-box;width: 1px;height: 100%;margin: 0 6px;border-right: 1px solid ",";"],e=>Object(I.c)(e).line);var se=e=>{const t=e.className,n=e.destSubreddit,o=e.editorKey,s=e.editorState,r=e.language,a=e.onChange,d=e.onEmoteButtonClick,c=e.onOverflowMenuClick,l=e.readOnly,m=e.trackOnClick,u=e.onLinkButtonClick,p=Object(W.a)(s);l&&Object(W.b)(p);const h=n&&d;return i.a.createElement($,{className:t,oveflowMenuDropdownId:o,onOverflowMenuClick:c},h&&i.a.createElement(ne,{controlsState:p,onEmoteButtonClick:d}),h&&i.a.createElement(oe,null),Object(Z.g)(Z.f,p,s,a,m,r),i.a.createElement(Z.a,{language:r,controlsState:p,trackOnClick:m,onLinkButtonClick:u}),Object(Z.g)(Z.h,p,s,a,m,r),i.a.createElement(oe,null),Object(Z.g)(Z.e,p,s,a,m,r),i.a.createElement(oe,null),i.a.createElement(Z.d,{language:r,controlsState:p,editorState:s,trackOnClick:m,onChange:a}))},re=n("./src/reddit/components/RichTextEditor/Toolbar/MarkdownButton/index.tsx"),ie=n("./src/reddit/constants/componentSizes.ts"),ae=n("./src/reddit/constants/componentTestIds.ts"),de=n("./src/reddit/constants/elementClassNames.ts"),ce=n("./src/reddit/controls/ErrorText/index.tsx"),le=n("./src/reddit/components/CommentCreation/ExpandingFormDiv.tsx"),me=n("./src/reddit/components/CommentCreation/FormFooter/index.tsx"),ue=n("./src/reddit/components/CommentCreation/getCancelModalId.ts"),pe=n("./src/reddit/components/CommentCreation/translations.ts"),he=n("./src/app/strings/index.ts"),be=n("./src/reddit/models/PostCreationForm/index.ts"),fe=n("./src/reddit/models/PostDraft/index.ts"),ge=n("./src/reddit/actions/modal.ts"),xe=n("./src/reddit/components/RichTextEditor/RTEState/index.tsx"),Ce=n("./src/reddit/contexts/PageLayer/index.tsx"),Ee=n("./src/reddit/contexts/PageLayer/selectors.ts"),we=n("./src/reddit/helpers/styles/components/index.tsx"),ye=n("./src/reddit/models/Subreddit/index.ts"),ve=n("./src/reddit/selectors/activeModalId.ts"),je=n("./src/reddit/selectors/comments.ts"),Oe=n("./src/reddit/selectors/user.ts"),Te=n("./src/reddit/components/CommentCreation/NavigationModule/index.ts"),ke=n("./src/reddit/components/CommentCreation/RichtextCommentForm/index.m.less"),Re=n.n(ke);const Me=Object(he.e)("comment.dontDigFancyPants"),Se=16,Ie=j()(Object(we.a)()).withConfig({componentId:"o61c31-0"})(["margin: ",";position: relative;."," {color: ",";min-height: ","px;word-break: break-word;}",""],e=>e.isTopLevelComment?"24px 40px":"16px 0 16px 22px",de.a,e=>Object(I.c)(e).bodyText,ie.z,e=>e.breakOut&&e.formHeight?`height: ${e.formHeight}px;`:""),Be=u.a.div("CommentHeader",Re.a),_e=u.a.wrapped(me.a,"FormFooter",Re.a),Fe=u.a.div("MarkdownButtonWrapper",Re.a),Pe=j()(re.a).withConfig({componentId:"o61c31-1"})(["&:hover {background-color: rgba(150, 150, 150, 0.05);}color: ",";min-width: 144px;padding-left: 0px;"],e=>Object(I.c)(e).button),De=u.a.wrapped(oe,"SectionSpacer",Re.a),Ne=u.a.div("ToolbarWrapper",Re.a),Ae=j.a.span.withConfig({componentId:"o61c31-2"})(["","color: ",";margin-right: 4px;"],S.bodyFontSmall,e=>Object(I.c)(e).bodyText),He=({cancelButtonEnabled:e,draftKey:t,onSubmit:n,onCancel:o,pending:s,submitButtonText:r})=>a=>{const d=a.language,c=a.editorState,l=a.onFtuTooltipClick,m=a.onMarkdownButtonClick,u=a.shouldShowFtuMessage,p=!!c.getCurrentContent().getPlainText().trim();return i.a.createElement(_e,{cancelButtonEnabled:e,onSubmit:n,onCancel:o,pending:s,submitButtonText:r,canSubmit:p},i.a.createElement(Ne,null,i.a.createElement(se,Object.assign({},a)),i.a.createElement(De,null),i.a.createElement(Fe,null,i.a.createElement(H,{onClick:l,shouldShowFtuMessage:!!u,text:Me(d)}),i.a.createElement(Pe,{draftKey:t,language:d,onClick:m,shouldHideTooltip:u}))))},ze=Object(a.b)(()=>Object(d.c)({activeModalId:ve.a,destSubreddit:(e,t)=>{const n=Object(Ee.q)(e,t);return n?{name:n.name,isProfile:n.type===ye.b.User,id:n.id}:void 0},draft:je.j,hasViewedMarkdownModeFtuUx:Oe.d}),(e,t)=>({cancelModalToggled:()=>e(Object(ge.i)(Object(ue.a)(t.draftKey)))}));var We=Object(Ce.w)()(ze(class extends i.a.Component{constructor(e){super(e),this.getToolbarRenderer=Object(T.a)((e,t,n,o)=>He({cancelButtonEnabled:e,draftKey:t,onSubmit:this.onSubmit,onCancel:this.onCancel,pending:n,submitButtonText:o})),this.focus=(()=>{this.editor&&this.editor.focus()}),this.setEditorWrapperRef=(e=>{this.editorWrapperElement=e,this.props.editorElementRef&&this.props.editorElementRef(e)}),this.setRTEComponentRef=(e=>this.editor=e),this.setRTEDomElementRef=(e=>{this.editorDomElement=e}),this.detectBreakout=(()=>{if(!this.editorWrapperElement||!this.editorWrapperElement.parentElement||this.props.isTopLevelComment)return;const e=this.editorWrapperElement.parentElement.getBoundingClientRect().width<ie.f,t=this.getWrapperHeight();e===this.state.breakOut&&t===this.state.formHeight||O.a.write(()=>{this.setState({breakOut:e,formHeight:t})})}),this.hasContent=(()=>{const e=this.state.rteState;return xe.a.hasContent(e)}),this.handleBlur=(()=>this.props.onFocusChanged(!1)),this.handleFocus=(()=>{this.props.onFocus(),this.props.onFocusChanged(!0)}),this.handleRTEStateInitialized=(e=>{this.props.onChange&&this.props.onChange({rteState:e}),this.setState({rteState:e})}),this.handleChange=((e,t)=>{const n=this.props.onChange;n&&n({rteState:e}),t&&this.setState({hasChanged:!0}),this.setState(()=>({showError:!1,rteState:e}),()=>{O.a.read(this.detectBreakout)})}),this.cancelForm=(()=>{this.editor&&this.props.draftType===fe.c.replyToPost&&this.setState({rteState:xe.a.createInitial()}),this.props.onCancel()}),this.shouldConfirmCancel=(()=>this.hasContent()&&this.state.hasChanged&&this.props.draftType===fe.c.edit),this.onCancel=(()=>{this.shouldConfirmCancel()?this.props.cancelModalToggled():this.cancelForm()}),this.onSubmit=(()=>{this.props.onSubmit({rteState:this.state.rteState,commentMode:be.h.RICH_TEXT,draftType:this.props.draftType})}),this.onSwitchEditorMode=((e,t)=>{this.props.onSwitchMode(e,t,this.props.draftKey)});const t=e.draftType,n=e.hasError,o=e.language,s=e.rtJson;this.state={breakOut:!1,cancelModalText:t===fe.c.edit?Object(he.a)(o,"comment.confirmCancellation.edit"):Object(he.a)(o,"comment.confirmCancellation.creation"),rteState:xe.a.createInitial(s),formHeight:void 0,hasChanged:!1,showError:n}}componentWillReceiveProps(e){this.props.draft&&this.props.draft.rteState&&e.draft&&null===e.draft.rteState&&this.setState({rteState:xe.a.createInitial()}),e.hasError!==this.props.hasError&&this.setState({showError:e.hasError})}componentWillUnmount(){this.props.onUnmount({rteState:this.state.rteState}),window.removeEventListener("resize",this.detectBreakout),this.props.instanceRef&&this.props.instanceRef(null)}componentDidMount(){this.props.draft.hasFocus&&this.editor&&(window.addEventListener("resize",this.detectBreakout),O.a.read(this.detectBreakout),O.a.write(()=>{this.props.draft.hasFocus&&this.editor&&this.editor.focus()})),this.props.instanceRef&&this.props.instanceRef(this)}getWrapperHeight(){if(this.editorDomElement)return this.editorDomElement.getBoundingClientRect().height+Se}render(){var e=this.props;const t=e.activeModalId,n=e.cancelModalToggled,o=e.className,s=e.depth,r=e.destSubreddit,a=e.draft,d=e.draftKey,c=e.draftType,l=e.errorMsgs,m=e.hasViewedMarkdownModeFtuUx,u=e.language,p=e.pending,h=e.submitButtonText,b=e.isTopLevelComment,f=e.userName;var g=this.state;const x=g.cancelModalText,C=g.breakOut,E=g.formHeight,w=g.rteState,v=Object(ue.a)(d),j=a.draftType===fe.c.edit,O=c!==fe.c.replyToPost;return i.a.createElement(Ie,{className:o,breakOut:C,isTopLevelComment:!!b,formHeight:C?E:void 0,innerRef:this.setEditorWrapperRef,pending:p,isFocused:a.hasFocus},b&&i.a.createElement(Be,null,i.a.createElement(Ae,null,"Comment as"),i.a.createElement(k.a,{author:f,isAdmin:!1,isAdminEmeritus:!1,isAuthorDeleted:!1,isMod:!1,isOp:!1},f)),i.a.createElement(le.a,{breakOut:C,depth:s,isEditing:j},i.a.createElement(z.b,{dataTestId:ae.c,destSubreddit:r,enableFtuMessage:!m,initialHeight:this.props.initialHeight,rteState:w,rteRef:this.setRTEComponentRef,domRef:this.setRTEDomElementRef,language:u,onBlur:this.handleBlur,onEditorResize:this.props.onEditorResize,onFocus:this.handleFocus,onChange:this.handleChange,onSubmit:this.onSubmit,onSwitchEditorMode:this.onSwitchEditorMode,placeholderText:"What are your thoughts?",readOnly:p,trackToolbarClick:y.a,toolbarPosition:"bottom",renderToolbar:this.getToolbarRenderer(O,d,p,h)})),this.state.showError?Object(ce.b)(l,u):null,t===v&&i.a.createElement(R.a,{actionText:Object(pe.a)(u),cancelActionText:Object(pe.b)(u),modalText:x,onConfirm:this.cancelForm,toggleModal:n,trackClick:y.a}),i.a.createElement(Te.a,{language:u,editKey:d,hasValue:xe.a.hasContent(w)}))}})),Le=n("./src/reddit/components/RequestPendingBanner/index.tsx"),Ke=n("./src/reddit/models/User/index.ts"),qe=n("./src/reddit/selectors/subreddit.ts");const Ue=Object(d.c)({contributorRequestPending:e=>Object(qe.i)(e,f.e.Comment),language:Oe.Q,userName:e=>e.user.account?Object(Ke.f)(e.user.account):"",pending:(e,t)=>e.comments.submit.pending[t.draftKey],hasError:je.x,errorMsgs:je.J,draft:je.j,disableAutofocus:je.g,showContributorRequestFlow:e=>Object(qe.v)(e,f.e.Comment)}),Ve=Object(a.b)(Ue,(e,t)=>({onMount:()=>e(c.J(t.draftKey)),onCancel:()=>{t.draftType===fe.c.edit?e(c.V({commentId:t.parentCommentId,commentsPageKey:t.commentsPageKey})):e(c.P({parentCommentId:t.parentCommentId,commentsPageKey:t.commentsPageKey}))},onUnmount:n=>e(c.hb(t.draftKey,n)),onFocus:s()(()=>e((e,n)=>Object(l.e)(n(),t.draftType))),onFocusChanged:n=>e(c.X({hasFocus:n,draftKey:t.draftKey})),onSwitchMode:(t,n,o)=>e(c.Q(t,n,o)),dispatchSubmit:(n,o)=>e(t.submitAction(n,o))}),(e,t,n)=>Object.assign({},e,t,n,{onSubmit:n=>t.dispatchSubmit(n,e.draft.commentMode)}));t.default=Ve(class extends i.a.Component{constructor(){super(...arguments),this.state={},this.getInstanceRef=(e=>this.formInstanceRef=e),this.onCancel=(()=>{this.props.onCancel()}),this.onSwitchMode=(async(e,t,n)=>{await this.props.onSwitchMode(e,t,n),this.formInstanceRef&&this.formInstanceRef.focus()}),this.onEditorResize=(e=>{this.setState({editorHeight:e})})}render(){const e=this.props,t=e&&e.draft&&e.draft.rtJson||e.rtJson||void 0,n={autofocus:e.autofocus||!1,className:e.className,depth:e.depth,disableAutofocus:e.disableAutofocus,draftKey:e.draftKey,draftType:e.draftType,editorElementRef:e.editorElementRef,errorMsgs:e.errorMsgs,initialHeight:this.state.editorHeight,instanceRef:this.getInstanceRef,hasError:e.hasError,language:e.language,onCancel:e.onCancel,onEditorResize:this.onEditorResize,onFocus:e.onFocus,onFocusChanged:e.onFocusChanged,onMount:e.onMount,onSubmit:e.onSubmit,onUnmount:e.onUnmount,pending:e.pending,rtJson:t,isTopLevelComment:e.isTopLevelComment,submitButtonText:e.submitButtonText,userName:e.userName,initialText:e.draft?e.draft.text:e.initialText||"",onSwitchMode:this.onSwitchMode};return e.contributorRequestPending?i.a.createElement(Le.a,null):e.showContributorRequestFlow?i.a.createElement(E,null):e.draft.commentMode===be.h.RICH_TEXT?i.a.createElement(We,Object.assign({},n)):i.a.createElement(m.b,Object.assign({},n))}})},"./src/reddit/components/CommentCreation/translations.ts":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return r});var o=n("./src/app/strings/index.ts");const s=Object(o.e)("comment.keep"),r=Object(o.e)("postCreation.discard.button");Object(o.e)("comment.confirmCancellation.creation")},"./src/reddit/components/CreateCommunityButton/index.m.less":function(e,t,n){e.exports={SecondaryButton:"_3U-J6NPoBHbyibarrb7T3F",secondaryButton:"_3U-J6NPoBHbyibarrb7T3F",StyledTooltip:"FIYolDqalszTnjjNfThfT",styledTooltip:"FIYolDqalszTnjjNfThfT"}},"./src/reddit/components/CreateCommunityButton/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/reselect/es/index.js"),a=n("./src/reddit/actions/tooltip.ts"),d=n("./src/reddit/components/InfoTextTooltip/index.tsx"),c=n("./src/reddit/components/TrackingHelper/index.tsx"),l=n("./src/reddit/controls/Button/index.tsx"),m=n("./src/reddit/helpers/overlay/index.ts"),u=n("./src/reddit/helpers/trackers/subredditCreation.ts"),p=n("./src/reddit/i18n/components.tsx"),h=n("./src/reddit/i18n/utils.ts"),b=n("./src/reddit/selectors/user.ts"),f=n("./src/reddit/components/CreateCommunityButton/index.m.less"),g=n.n(f),x=n("./src/lib/lessComponent.tsx");const C="create-community-button",E=x.a.wrapped(l.i,"SecondaryButton",g.a),w=x.a.wrapped(d.c,"StyledTooltip",g.a),y=Object(i.c)({userDoesNotHaveEnoughExpToCreateCommunity:e=>!Object(b.ab)(e),userIsSuspended:b.M});t.a=Object(r.b)(y,(e,{eventSource:t})=>({openCommunityCreation:n=>{n(Object(u.a)(t)),e(Object(m.a)("/subreddits/create"))},onShowTooltip:()=>e(Object(a.d)({tooltipId:C})),onHideTooltip:()=>e(Object(a.f)())}))(Object(c.b)(({eventSource:e,onShowTooltip:t,onHideTooltip:n,openCommunityCreation:o,sendEvent:r,userDoesNotHaveEnoughExpToCreateCommunity:i,userIsSuspended:a})=>s.a.createElement(E,{disabled:a||i,onClick:()=>o(r),onMouseEnter:t,onMouseLeave:n,id:C},s.a.createElement(p.c,null,"Create Community"),i?s.a.createElement(w,{caretOnTop:!0,tooltipId:C,text:Object(h.c)("To prevent spam, accounts must be at least 30 days old and have enough positive karma to create communities.")}):a?s.a.createElement(w,{caretOnTop:!0,tooltipId:C,text:Object(h.c)("Accounts banned from the site can not create communities until the ban is lifted.")}):null)))},"./src/reddit/components/InfoBanners/BannerBase/index.m.less":function(e,t,n){e.exports={IconWrapper:"_2p07tPrx9WpxDTQJ5cmVNe",iconWrapper:"_2p07tPrx9WpxDTQJ5cmVNe",TextWrapper:"_2jpm-rNr0Hniw6BX3NWMVe",textWrapper:"_2jpm-rNr0Hniw6BX3NWMVe",leftSideRectangle:"_3TLlMYjrPH9Kl9522LpSxb",wrapper:"_1DUKbp8va6vxOv9zemBDBi",subtitle:"_2J85dtk0HKQBLk8HTSWduv",title:"Nt8TnDvJ2BsL8KWcFQKy5"}},"./src/reddit/components/InfoBanners/BannerBase/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./src/lib/classNames/index.ts"),i=n("./src/reddit/components/InfoBanners/BannerBase/index.m.less"),a=n.n(i),d=n("./src/lib/lessComponent.tsx");const c=d.a.div("IconWrapper",a.a),l=d.a.div("TextWrapper",a.a);t.a=(e=>{const t=e.className,n=e.color,o=e.icon,i=e.subtitle,d=e.title;return s.a.createElement("div",{className:Object(r.a)(t,a.a.wrapper),style:n&&{borderColor:n}||{}},s.a.createElement("div",{className:a.a.leftSideRectangle,style:n&&{backgroundColor:n}||{}}),o?s.a.createElement(c,null,o):s.a.createElement(c,null),s.a.createElement(l,null,s.a.createElement("div",{className:a.a.title},d),i&&s.a.createElement("div",{className:a.a.subtitle},i)))})},"./src/reddit/components/MarkdownHelp/index.tsx":function(e,t,n){"use strict";n.d(t,"b",function(){return E});var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-redux/es/index.js"),i=n("./bundled-modules/styled-components/styled-components.min.js"),a=n.n(i),d=n("./src/reddit/components/FlairPickerTitle/index.tsx"),c=n("./src/reddit/components/FlairPickerWrapper/index.tsx"),l=n("./src/reddit/components/RichTextJson/elements.tsx"),m=n("./src/reddit/components/RichTextJson/SpoilerText.tsx"),u=n("./src/reddit/components/TrackingHelper/index.tsx"),p=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),h=n("./src/higherOrderComponents/asModal.tsx"),b=n("./src/reddit/actions/modal.ts"),f=n("./src/reddit/controls/Button/index.tsx"),g=n("./src/reddit/layout/row/Inline/index.tsx"),x=n("./src/reddit/layout/row/RightAlign/index.tsx"),C=n("./src/reddit/models/Theme/NewColorSystem/index.ts");const E="Markdown_Help__Modal",w=a()(g.a).withConfig({componentId:"s17joo32-0"})(["border: none;padding: 16px;"]),y=a.a.div.withConfig({componentId:"s17joo32-1"})(["color: ",";padding: 8px;.help-table {width: 100%;}"],e=>Object(C.c)(e).bodyText),v=a.a.table.withConfig({componentId:"s17joo32-2"})(["margin: 12px 0;"]),j=a.a.p.withConfig({componentId:"s17joo32-3"})(["",""],p.metadataFont);const O=Object(r.b)(null,(e,t)=>({closeModal:()=>e(Object(b.i)(E))}))(class extends s.a.Component{render(){return s.a.createElement(c.a,null,s.a.createElement(d.a,{onClosePressed:this.props.closeModal,title:"Markdown Help"}),s.a.createElement(y,null,s.a.createElement(v,{className:"help-table"},s.a.createElement("tr",null,s.a.createElement(l.s,null,s.a.createElement(l.j,null,"Type this:")),s.a.createElement(l.s,null,s.a.createElement(l.j,null,"to get this:"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"*italics*")),s.a.createElement(l.p,null,s.a.createElement(l.f,null,"italics"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"**bold**")),s.a.createElement(l.p,null,s.a.createElement(l.b,null,"bold"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"[reddit!](https://reddit.com)")),s.a.createElement(l.p,null,s.a.createElement(l.a,{href:"https://www.reddit.com"},"reddit!"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"* item 1"),s.a.createElement(l.j,null,"* item 2"),s.a.createElement(l.j,null,"* item 3")),s.a.createElement(l.p,null,s.a.createElement(l.v,null,s.a.createElement(l.g,null,"item 1"),s.a.createElement(l.g,null,"item 2"),s.a.createElement(l.g,null,"item 3")))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"> quoted text")),s.a.createElement(l.p,null,s.a.createElement(l.c,null,"quoted text"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"~~strikethrough~~")),s.a.createElement(l.p,null,s.a.createElement(l.d,null,"strikethrough"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,"super^script")),s.a.createElement(l.p,null,"super",s.a.createElement(l.m,null,"script"))),s.a.createElement("tr",null,s.a.createElement(l.p,null,s.a.createElement(l.j,null,">!spoilers!<")),s.a.createElement(l.p,null,s.a.createElement(m.a,null,"spoilers")))),s.a.createElement(j,null,"Check the",s.a.createElement(l.a,{href:"https://www.reddit.com/wiki/commenting"}," commenting wiki page "),"for more help")),s.a.createElement(w,null,s.a.createElement(x.a,null,s.a.createElement(f.f,{onClick:this.props.closeModal,"data-redditstyle":!0},"Close"))))}});t.a=Object(h.a)(Object(u.b)(O))},"./src/reddit/components/PostCreationForm/MarkdownEditor/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/reselect/es/index.js"),a=n("./bundled-modules/styled-components/styled-components.min.js"),d=n.n(a),c=n("./src/reddit/actions/postCreation/general.ts"),l=n("./src/reddit/components/CommentCreation/MarkdownCommentForm/index.tsx"),m=n("./src/reddit/components/FocusableContent/index.tsx"),u=n("./src/reddit/components/MarkdownHelp/index.tsx"),p=n("./src/reddit/components/PostCreationForm/Prompt/index.tsx"),h=n("./src/reddit/components/ResizableAutosizeTextarea/index.tsx"),b=n("./src/reddit/constants/keycodes.ts"),f=n("./src/reddit/controls/LoadingIcon/index.tsx"),g=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),x=n("./src/reddit/models/PostCreationForm/index.ts"),C=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),E=n("./src/reddit/selectors/activeModalId.ts"),w=n("./src/reddit/selectors/editorContent.ts");const y=d()(f.a).withConfig({componentId:"s1pnvvwf-0"})(["display: inline-block;margin-right: 4px;margin-bottom: -4px;border-top: .6em solid rgba(192, 192, 192, 0.7);border-right: .6em solid rgba(192, 192, 192, 0.7);border-bottom: .6em solid rgba(192, 192, 192, 0.7);border-left: .6em solid rgba(192, 192, 192, 0);"]),v=d.a.span.withConfig({componentId:"s1pnvvwf-1"})(["","border-radius: 4px;color: ",";"],g.titleFontH5,e=>Object(C.c)(e).bodyText),j=d.a.div.withConfig({componentId:"s1pnvvwf-2"})(["display: flex;align-items: flex-end;"]),O=d.a.button.withConfig({componentId:"s1pnvvwf-3"})(["","color: ",";"],g.bodyFontSmall,e=>Object(C.c)(e).button),T=d()(l.a).withConfig({componentId:"s1pnvvwf-4"})(["margin-left: 8px;"]),k=d.a.div.withConfig({componentId:"s1pnvvwf-5"})(["border-top-left-radius: 4px;border-top-right-radius: 4px;height: 20px;padding: 8px 16px;background-color: ",";display: flex;align-items: center;justify-content: space-between;"],e=>Object(C.c)(e).field),R=Object(i.c)({activeModalId:E.a,isConverting:e=>Object(w.a)(e)}),M=Object(r.b)(R,(e,t)=>({onChange:n=>{e(Object(c.c)(n)),t.onChange&&t.onChange(n)},helpModalToggled:()=>e(Object(c.y)(u.b)),switchToRTEModalToggled:()=>e(Object(c.y)(p.c))}));t.a=M(class extends s.a.Component{constructor(e){super(e),this.textAreaRef=null,this.onChange=(e=>{const t=e.currentTarget.value;this.props.onChange(t)}),this.onBlur=(()=>{this.setState({isFocused:!1}),this.props.onBlur&&this.props.onBlur()}),this.onFocus=(()=>{const e=this.props.onFocus;e&&e(),this.setState({isFocused:!0})}),this.handleKeyDown=(e=>{const t=e.ctrlKey,n=e.metaKey,o=e.keyCode;(t||n)&&o===b.a.Enter&&this.props.onSubmit()}),this.handleSwitchModeClick=(()=>{this.props.value?this.props.switchToRTEModalToggled():this.props.onSwitchEditorMode(x.h.RICH_TEXT,this.props.value)}),this.handleSwitchToRTEConfirm=(()=>{this.props.switchToRTEModalToggled(),this.props.onSwitchEditorMode(x.h.RICH_TEXT,this.props.value)}),this.setTextAreaRef=(e=>this.textAreaRef=e),this.state={isFocused:!1}}componentDidMount(){const e=this.props.instanceRef;e&&e(this)}componentWillUnmount(){const e=this.props.instanceRef;e&&e(null)}focus(){this.textAreaRef&&this.textAreaRef.focus()}render(){var e=this.props;const t=e.className,n=e.isConverting,o=e.placeholderText,r=e.value,i=this.state.isFocused;return s.a.createElement("div",{className:t},s.a.createElement(m.a,{isFocused:i},s.a.createElement(k,null,s.a.createElement(j,null,s.a.createElement(v,null,"Markdown"),s.a.createElement(T,{onClick:this.props.helpModalToggled})),s.a.createElement(O,{onClick:this.handleSwitchModeClick},n&&s.a.createElement(y,{sizePx:12}),"Switch to Fancy Pants Editor")),s.a.createElement(h.a,{disabled:!!this.props.disabled,initialHeight:this.props.initialHeight,innerRef:this.setTextAreaRef,onBlur:this.onBlur,onChange:this.onChange,onEditorResize:this.props.onEditorResize,onFocus:this.onFocus,onKeyDown:this.handleKeyDown,placeholder:o,value:r})),this.props.activeModalId===u.b&&s.a.createElement(u.a,{language:this.props.language}),this.props.activeModalId===p.c&&s.a.createElement(p.d,{modalId:p.c,onCancel:this.props.switchToRTEModalToggled,onConfirm:this.handleSwitchToRTEConfirm}))}})},"./src/reddit/components/PostCreationForm/Prompt/PromptModal.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./bundled-modules/styled-components/styled-components.min.js"),i=n.n(r),a=n("./src/higherOrderComponents/asModal.tsx"),d=n("./src/reddit/components/ModalStyledComponents/index.tsx"),c=n("./src/reddit/constants/keycodes.ts"),l=n("./src/reddit/controls/Button/index.tsx"),m=n("./src/reddit/controls/TextButton/index.tsx"),u=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),p=n("./src/reddit/layout/twoCol/ExpandLeft/index.tsx");const h=i()(l.f).withConfig({componentId:"u0dwnt-0"})(["margin-left: 8px;"]),b=i()(d.k).withConfig({componentId:"u0dwnt-1"})(["",""],u.bodyFont);t.a=Object(a.a)(class extends s.a.PureComponent{constructor(){super(...arguments),this.handleEscapeKey=(e=>{e.keyCode===c.a.Escape&&this.props.onClose()})}componentDidMount(){document.addEventListener("keydown",this.handleEscapeKey)}componentWillUnmount(){document.removeEventListener("keydown",this.handleEscapeKey)}render(){return s.a.createElement(d.c,null,s.a.createElement(d.g,null,s.a.createElement(p.b,null,s.a.createElement(d.l,null,this.props.titleText),s.a.createElement(m.a,{onClick:this.props.onClose},s.a.createElement(d.b,null)))),s.a.createElement(d.h,null,s.a.createElement(b,null,this.props.bodyText)),s.a.createElement(d.e,null,s.a.createElement(d.a,{onClick:this.props.onSecondaryAction},this.props.secondaryButtonText),s.a.createElement(h,{onClick:this.props.onPrimaryAction},this.props.primaryButtonText)))}})},"./src/reddit/components/PostCreationForm/Prompt/index.tsx":function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return u});var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/reselect/es/index.js"),a=n("./src/app/strings/index.ts"),d=n("./src/reddit/selectors/user.ts"),c=n("./src/reddit/components/PostCreationForm/Prompt/PromptModal.tsx");const l="POST_CREATION__LOAD_DRAFT_MODAL_ID",m="POST_CREATION__MAX_DRAFTS_MODAL_ID",u="MARKDOWN_EDITOR__SWITCH_TO_RTE_MODAL_ID",p=(e,t)=>`postCreation.prompt.${e}.${t}`,h={body:p("default","body"),cancel:"postCreation.cancel",confirm:p("default","confirm"),title:p("default","title")},b=Object.assign({},h,{body:p("loadDraft","body"),confirm:p("loadDraft","confirm"),title:p("loadDraft","title")}),f=Object.assign({},h,{body:p("maxDrafts","body"),confirm:p("maxDrafts","confirm"),title:p("maxDrafts","title")}),g=Object.assign({},h,{body:p("switchToRTE","body"),confirm:p("switchToRTE","confirm"),title:p("switchToRTE","title")}),x={[l]:b,[m]:f,[u]:g},C=Object(i.c)({language:d.Q}),E=Object(r.b)(C),w=(e,t)=>({bodyText:Object(a.a)(e,t.body),secondaryButtonText:Object(a.a)(e,t.cancel),primaryButtonText:Object(a.a)(e,t.confirm),titleText:Object(a.a)(e,t.title)});t.d=E(class extends s.a.PureComponent{constructor(){super(...arguments),this.onCancel=(()=>{this.props.onCancel(this.props.modalId)}),this.onConfirm=(()=>{this.props.onConfirm(this.props.modalId)})}render(){var e=this.props;const t=e.language,n=e.modalId;return s.a.createElement(c.a,Object.assign({},w(t,x[n]),{onClose:this.onCancel,onPrimaryAction:this.onConfirm,onSecondaryAction:this.onCancel}))}})},"./src/reddit/components/PostEditForm/index.tsx":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/lodash/noop.js"),s=n.n(o),r=n("./node_modules/react/index.js"),i=n.n(r),a=n("./node_modules/react-redux/es/index.js"),d=n("./node_modules/react-router-redux/es/index.js"),c=n("./src/reddit/i18n/components.tsx"),l=n("./node_modules/reselect/es/index.js"),m=n("./bundled-modules/styled-components/styled-components.min.js"),u=n.n(m),p=n("./src/app/strings/index.ts"),h=n("./src/reddit/helpers/correlationIdTracker.ts"),b=n("./src/reddit/models/PostCreationForm/index.ts"),f=n("./src/reddit/selectors/postCreations.ts"),g=n("./src/reddit/actions/postCreation/editing.ts"),x=n("./src/reddit/actions/postCreation/editorContent.ts"),C=n("./src/reddit/components/CommentCreation/NavigationModule/index.ts"),E=n("./src/lib/constants/index.ts"),w=n("./src/lib/memoizeByReference/index.ts"),y=n("./src/reddit/components/RichTextEditor/media/helpers.ts");const v=Object(w.a)((e,t,n)=>{const o=e.name,s=e.allowedPostTypes,r=Object(y.f)(t),i=((e,t,n,o)=>{if(!t)return null;let s="";return!e.total||t.images||t.videos?e.video&&!t.videos?s="postCreation.mediaInput.videosAreNotAllowed":!e.image&&!e.gifvideo||t.images||(s="postCreation.mediaInput.imagesAreNotAllowed"):s="postCreation.mediaInput.mediaAreNotAllowed",s?Object(p.a)(o,s,{subredditName:n}):null})(r,s,o,n);return i?[i]:((e,t)=>{const n=[];return e.image>E.T&&n.push(Object(p.a)(t,"postCreation.mediaInput.imagesLimitExceeded")),e.video+e.gifvideo>E.W&&n.push(Object(p.a)(t,"postCreation.mediaInput.videosLimitExceeded")),n})(r,n)});var j=n("./src/reddit/components/PostCreationForm/MarkdownEditor/index.tsx"),O=n("./src/reddit/components/RichTextEditor/index.tsx"),T=n("./src/reddit/components/RichTextEditor/RTEState/index.tsx"),k=n("./src/reddit/contexts/PageLayer/index.tsx"),R=n("./src/reddit/controls/ErrorText/index.tsx"),M=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),S=n("./src/reddit/selectors/user.ts"),I=n("./src/reddit/controls/Button/index.tsx"),B=n("./src/reddit/controls/LoadingIcon/index.tsx");const _=Object(p.e)("postCreation.rtfPlaceholderOptional"),F=Object(p.e)("postCreation.rtfPlaceholderRequired"),P=u.a.div.withConfig({componentId:"s1jd7h1p-0"})(["display: flex;flex-direction: row;justify-content: flex-end;margin-top: 8px;"]),D=u.a.div.withConfig({componentId:"s1jd7h1p-1"})(["display: flex;align-items: flex-end;flex-flow: column nowrap;overflow: hidden;white-space: nowrap;"]),N=u()(O.b).withConfig({componentId:"s1jd7h1p-2"})(["color: #222;opacity: ",";"],e=>e.pending?"0.6":"1"),A=u.a.div.withConfig({componentId:"s1jd7h1p-3"})(["padding: 8px;cursor: text;color: ",";"],e=>Object(M.c)(e).body),H=u()(I.f).withConfig({componentId:"s1jd7h1p-4"})(["min-width: 90px;min-height: 27px;padding: 5px 10px;line-height: normal;"]),z=u()(B.a).withConfig({componentId:"s1jd7h1p-5"})(["display: inline-block;margin-bottom: -3px;"]),W=Object(k.w)(),L=Object(l.c)({destSubreddit:f.f,editorMode:f.g,errorText:f.h,hasError:f.i,language:S.Q,markdownDraft:f.j,pending:f.P,postingRequirements:(e,{pageLayer:t})=>{const n=Object(k.t)(e,{pageLayer:t});if(n)return e.subredditSettings.requirementsBySubreddit[n.name.toLowerCase()]},rteDraft:f.k,subreddit:k.t,uploads:e=>e.uploads,user:S.j}),K=Object(a.b)(L,(e,t)=>({onCancel:t=>e(g.b(t)),onSubmitDraft:t=>e(g.c(t)),onSuccess:t=>e(Object(d.b)(t)),onToggleEditorMode:(t,n)=>e(x.d(b.g.POST_EDITING,t,n))}));t.default=W(K(class extends i.a.Component{constructor(e){super(e),this.onEditorResize=(e=>{this.setState({editorHeight:e})}),this.onMarkdownPostChange=(e=>{const t=this.state.markdownBody,n=this.state.markdownPostDraftChanged||t.trim()!==e.trim();this.setState({markdownBody:e,markdownPostDraftChanged:n})}),this.onRichPostChange=((e,t)=>{this.setState({rteState:e,richtextPostDraftChanged:this.state.richtextPostDraftChanged||t})}),this.haveMarkdownPostDraft=(()=>!!(this.state.markdownBody||"").trim()),this.haveDraft=(()=>this.props.editorMode===b.h.RICH_TEXT?this.haveRichPostDraft():this.haveMarkdownPostDraft()),this.onSubmit=(()=>{const e=this.buildPostSubmission();e&&this.props.onSubmitDraft(e)}),this.onToggleEditorMode=(async(e,t)=>{this.setState({markdownPostDraftChanged:!1,richtextPostDraftChanged:!1}),await this.props.onToggleEditorMode(e,t),e===b.h.RICH_TEXT?this.rteRef&&this.rteRef.focus():this.markdownEditorRef&&this.markdownEditorRef.focus()}),this.getMediaValidationErrors=(()=>{var e=this.props;const t=e.editorMode,n=e.destSubreddit,o=e.language,s=this.state.rteState;return s.isBound&&t===b.h.RICH_TEXT?v(n,s.editorState.getCurrentContent(),o):[]}),this.getTextPostContent=(()=>{var e=this.props;const t=e.editorMode,n=e.uploads;var o=this.state;const s=o.markdownBody,r=o.rteState;return t===b.h.RICH_TEXT?T.a.toRichTextJSON(r,n):{markdown:s}}),this.buildPostSubmission=(()=>{const e=this.props.post;return Object.assign({post:e},this.getTextPostContent(),{validate_on_submit:!0})}),this.cancelEdit=(()=>{this.props.onCancel(this.props.post.id)}),this.setRteRef=(e=>this.rteRef=e),this.setMarkdownEditorRef=(e=>this.markdownEditorRef=e),this.state={markdownBody:e.markdownDraft,markdownPostDraftChanged:!1,richtextPostDraftChanged:!1,rteState:e.rteDraft}}componentDidMount(){Object(h.d)(h.a.PostComposer)}componentWillUnmount(){Object(h.b)(h.a.PostComposer),this.cancelEdit()}componentWillReceiveProps(e){e.rteDraft!==this.props.rteDraft&&this.setState({rteState:e.rteDraft,richtextPostDraftChanged:!0}),e.markdownDraft!==this.props.markdownDraft&&this.setState({markdownBody:e.markdownDraft,markdownPostDraftChanged:!0})}haveRichPostDraft(){const e=this.state.rteState;return T.a.hasContent(e)}hasChanged(){const e=this.props.editorMode;var t=this.state;const n=t.markdownPostDraftChanged,o=t.richtextPostDraftChanged;return e===b.h.RICH_TEXT?!!o:e===b.h.MARKDOWN&&!!n}render(){var e=this.props;const t=e.language,n=e.pending,o=e.editorMode,r=e.errorText,a=e.hasError,d=e.post,l=e.postingRequirements;var m=this.state;const u=m.markdownBody,h=m.markdownPostDraftChanged,f=m.richtextPostDraftChanged,g=m.rteState,x=l&&"required"===l.ruleBodyRequirement?F(t):_(t),E=this.getMediaValidationErrors(),w=a?[r||Object(p.a)(t,"error.type.generic")]:E;return i.a.createElement(A,null,o===b.h.RICH_TEXT?i.a.createElement(N,{allowMedia:!0,destSubreddit:this.props.destSubreddit,initialHeight:this.state.editorHeight,rteState:g,language:t,onChange:this.onRichPostChange,onEditorResize:this.onEditorResize,onSubmit:this.onSubmit,onSwitchEditorMode:this.onToggleEditorMode,pending:!!n,readOnly:!!n,rteRef:this.setRteRef,trackToolbarClick:s.a,placeholderText:x}):i.a.createElement(j.a,{language:t,initialHeight:this.state.editorHeight,instanceRef:this.setMarkdownEditorRef,disabled:!!n,value:u,onChange:this.onMarkdownPostChange,onEditorResize:this.onEditorResize,onSubmit:this.onSubmit,onSwitchEditorMode:this.onToggleEditorMode,placeholderText:x}),i.a.createElement(P,null,i.a.createElement(I.n,{disabled:!!n,onClick:this.cancelEdit},i.a.createElement(c.c,null,"cancel")),i.a.createElement(H,{disabled:!!n||!!E.length||!this.hasChanged(),onClick:this.onSubmit},n?i.a.createElement(z,{sizePx:10}):Object(p.a)(t,"posts.save"))),i.a.createElement(D,null,!!w.length&&Object(R.b)(w,t)),i.a.createElement(C.a,{editKey:d.id,language:t,hasValue:!(!h&&!f),isPostEdit:!0}))}}))},"./src/reddit/components/RequestPendingBanner/index.m.less":function(e,t,n){e.exports={Banner:"_1AD-JX9FUzLgvv8A5yaVqV",banner:"_1AD-JX9FUzLgvv8A5yaVqV",Subtitle:"_1ljRPHbvpC41amZF9_xBeb",subtitle:"_1ljRPHbvpC41amZF9_xBeb"}},"./src/reddit/components/RequestPendingBanner/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/reselect/es/index.js"),a=n("./src/lib/lessComponent.tsx"),d=n("./src/reddit/components/InfoBanners/BannerBase/index.tsx"),c=n("./src/reddit/i18n/utils.ts"),l=n("./src/reddit/models/SubredditRestrictions/index.ts"),m=n("./src/reddit/selectors/platform.ts"),u=n("./src/reddit/selectors/subreddit.ts"),p=n("./src/reddit/components/RequestPendingBanner/index.m.less"),h=n.n(p);const b=a.a.wrapped(d.a,"Banner",h.a),f=Object(r.b)(()=>Object(i.c)({restrictions:u.r,subreddit:m.f}));t.a=f(({restrictions:e,subreddit:t})=>{if(!t)return null;const n=e===l.e.Comment?l.a.Create:l.a.Draft;return s.a.createElement(b,{subtitle:s.a.createElement("span",{className:h.a.Subtitle},Object(c.c)(`Your request to ${Object(c.b)("restrictions",l.d[e])} in r/${Object(c.b)("displayName",t.name)} was sent and is pending. In the meantime, you can ${Object(c.b)("action",l.c[n])} a post and `),s.a.createElement("a",{href:`${t.url}`},Object(c.c)("browse the community"))),title:Object(c.c)(`Request to ${Object(c.b)("restrictions",l.d[e])} is pending...`)})})},"./src/reddit/components/ResizableAutosizeTextarea/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./node_modules/react-autosize-textarea/lib/index.js"),i=n.n(r),a=n("./bundled-modules/styled-components/styled-components.min.js"),d=n.n(a),c=n("./src/reddit/constants/componentSizes.ts"),l=n("./src/reddit/helpers/styles/mixins/fonts.tsx"),m=n("./src/reddit/models/Theme/NewColorSystem/index.ts"),u=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&(n[o[s]]=e[o[s]])}return n};const p=d()(({className:e,children:t,editorWrapperRef:n})=>s.a.createElement("div",{className:e,ref:n},t)).withConfig({componentId:"lx9wgs-0"})(["background-color: ",";height: ",";min-height: ","px;overflow: hidden auto;padding: ","px ","px;resize: vertical;"],e=>Object(m.c)(e).body,e=>e.initialHeight?`${e.initialHeight}px`:"unset",c.z,c.A,c.B),h=d()(e=>{e.isFullHeight;var t=e.textAreaRef,n=u(e,["isFullHeight","textAreaRef"]);return s.a.createElement(i.a,Object.assign({innerRef:t},n))}).withConfig({componentId:"lx9wgs-1"})(["","background: transparent;border: none;box-sizing: border-box;caret-color: ",";color: ",";display: block;min-height: ",";outline: none;resize: none;width: 100%;&:disabled,&:placeholder-shown {opacity: 0.5;}"],l.bodyFontMono,e=>Object(m.c)(e).button,e=>Object(m.c)(e).bodyText,e=>e.isFullHeight?"100%":`${c.z}px`);t.a=class extends s.a.Component{constructor(e){super(e),this.editorHeight=null,this.editorRef=null,this.editorStyleMutationObserver=null,this.onEditorStyleChanged=(()=>{if(!this.editorRef)return;this.state.isResized||this.setState({isResized:!0});const e=this.editorRef.style.height?Number.parseInt(this.editorRef.style.height):null;this.editorHeight!==e&&(this.editorHeight=e,e&&this.props.onEditorResize&&this.props.onEditorResize(e))}),this.setEditorWrapperRef=(e=>this.editorRef=e),this.state={initialHeight:e.initialHeight,isResized:!!e.initialHeight}}componentDidMount(){this.editorRef&&(this.editorStyleMutationObserver=new MutationObserver(this.onEditorStyleChanged),this.editorStyleMutationObserver.observe(this.editorRef,{attributes:!0,attributeFilter:["style"]}))}componentWillUnmount(){this.editorStyleMutationObserver&&(this.editorStyleMutationObserver.disconnect(),this.editorStyleMutationObserver=null)}render(){const e=this.props,t=e.initialHeight,n=e.innerRef,o=(e.onEditorResize,u(e,["initialHeight","innerRef","onEditorResize"])),r=this.state.isResized;return s.a.createElement(p,{editorWrapperRef:this.setEditorWrapperRef,initialHeight:t},s.a.createElement(h,Object.assign({},o,{children:!0,isFullHeight:!!r,textAreaRef:n})))}}},"./src/reddit/constants/accountManager.ts":function(e,t,n){"use strict";var o,s;n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s}),function(e){e.Index="/login/",e.Register="/register/"}(o||(o={})),function(e){e.CreateAccount="createAccount",e.Login="login",e.Register="register",e.Subscribe="subscribe"}(s||(s={}))},"./src/reddit/constants/elementClassNames.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"f",function(){return a}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return c}),n.d(t,"e",function(){return l});const o="public-DraftEditor-content",s="DraftEditor-root",r="DraftEditor-contentwrapper",i="public-DraftStyleDefault-block",a="hovered",d="scrollerItem",c="threadline",l="header-user-dropdown"},"./src/reddit/controls/ToggleSwitch/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/polished/dist/polished.es.js"),s=n("./node_modules/react/index.js"),r=n.n(s),i=n("./bundled-modules/styled-components/styled-components.min.js"),a=n.n(i),d=n("./src/reddit/models/Theme/NewColorSystem/index.ts");const c=a.a.div.withConfig({componentId:"s1c80vsd-0"})(["background-color: #FFFFFF;box-shadow: 0 0 0 1px rgba(0,0,0,0.1), 0 2px 3px 0 rgba(0,0,0,0.2);transition: left 0.15s linear;border-radius: ","%;width: ","%;&::after {content: '';padding-top: 100%;display: block;}"],.57*100,.57*100);t.a=a()(e=>r.a.createElement("button",{"aria-checked":e.on,className:e.className,id:e.id,role:"switch",tabIndex:e.tabIndex,type:"button",onClick:()=>!e.disabled&&e.onToggle&&e.onToggle()},r.a.createElement(c,null))).withConfig({componentId:"s1c80vsd-1"})(["display: flex;justify-content: ",";background-color: ",";border: 2px solid transparent;border-radius: 100px;cursor: ",";position: relative;width: 35px;transition: border-color 0.15s linear,background-color 0.15s linear;"," {","}"],e=>e.on&&!e.disabled?"flex-end":"flex-start",e=>e.on&&!e.disabled?e.activeColorOverride||Object(d.c)(e).active:Object(o.g)(Object(d.c)(e).navIcon,.08),e=>e.disabled?"default ":"pointer",c,e=>e.disabled?"box-shadow: none;":"")},"./src/reddit/endpoints/economics/specialMembership.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return u});var o=n("./src/config.ts"),s=n("./src/lib/omitHeaders/index.ts"),r=n("./src/reddit/constants/headers.ts"),i=n("./src/reddit/endpoints/governance/requester.ts"),a=n("./src/reddit/helpers/r2/normalizeSubredditFromR2/index.ts");function d(e,t){return Object(i.a)(e,{endpoint:`${o.a.metaUrl}/communities/${t.subredditId}/me`,method:"patch",data:{specialMemberships:{settings:{renew:!1}}}})}function c(e){return Object(i.a)(e,{endpoint:`${o.a.metaUrl}/users/me`,method:"get"}).then(e=>e.ok?e.body.specialMemberships?Object.assign({},e,{body:e.body.specialMemberships}):Object.assign({},e,{body:{}}):e)}function l(e){return Object(i.a)(e,{endpoint:`${o.a.metaUrl}/ps/me/braintree-client-tokens`,method:"post"})}function m(e,t){return Object(i.a)(e,{endpoint:`${o.a.metaUrl}/orders`,method:"post",data:{currency:"usd",orderTarget:"special_membership",price:t.price,products:[{productId:"membership",quantity:"1"}],providerArgs:{paymentNonce:t.nonce,savePaymentMethod:!0},providerName:"braintree",subredditId:t.subredditId,targetArgs:{renew:!0}}})}function u(e,t){return Object(i.a)(Object(s.a)(e,[r.a]),{endpoint:`${e.apiUrl}/api/info?id=${t.join(",")}`,method:"get"}).then(e=>{if(e.ok){const t=e.body.data.children.map(({data:e})=>Object(a.a)(e)).reduce((e,t)=>(e[t.id]=t,e),{});return Object.assign({},e,{body:t})}return e})}},"./src/reddit/helpers/trackers/monthsToMinutes.ts":function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return p}),n.d(t,"h",function(){return b}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return g}),n.d(t,"k",function(){return x}),n.d(t,"j",function(){return E}),n.d(t,"i",function(){return w});var o=n("./src/reddit/selectors/experiments/m2mHomeRedirect.ts"),s=n("./src/reddit/selectors/experiments/m2mV1-5.ts"),r=n("./src/reddit/selectors/subreddit.ts"),i=n("./src/reddit/selectors/telemetry.ts");const a=e=>{const t=Object(o.c)(e),n=Object(s.f)(e);return Object.assign({},i.defaults(e),{actionInfo:i.actionInfo(e,{settingValue:t||Object(s.e)(n)?"top_banner":"footer_banner"}),noun:"account_complete",source:"banner"})},d=()=>e=>Object.assign({},a(e),{action:"view"}),c=e=>t=>Object.assign({},a(t),{action:"click",banner:{id:e,buttonText:e}}),l=e=>t=>{const n=a(t);return Object.assign({},n,{action:"click",actionInfo:Object.assign({},n.actionInfo,{reason:e?"expand":"collapse"})})},m=e=>Object.assign({},i.defaults(e),{source:"community_manager"}),u=e=>t=>Object.assign({},m(t),{action:"click",noun:"subreddit_name",subreddit:{id:Object(r.J)(t,e),name:e}}),p=e=>t=>Object.assign({},m(t),{action:"click",noun:"remove_subreddit",subreddit:{id:Object(r.J)(t,e),name:e}}),h=e=>Object.assign({},i.defaults(e),{noun:"home_active",source:"tooltip"}),b=()=>e=>Object.assign({},h(e),{action:"view",tooltip:{id:"home_unlock",text:"home_unlock"}}),f=e=>t=>Object.assign({},h(t),{action:"click",tooltip:{id:"home_unlock",text:e}}),g=()=>e=>Object.assign({},i.defaults(e),{action:"click",noun:"sign_up",source:"id_card"}),x=e=>t=>Object.assign({},i.defaults(t),{action:"click",noun:e,source:"community_nav"}),C=e=>Object.assign({},i.defaults(e),{noun:"starter_home",source:"banner"}),E=()=>e=>Object.assign({},C(e),{action:"view"}),w=()=>e=>Object.assign({},C(e),{action:"click",actionInfo:i.actionInfo(e,{reason:"close"})})},"./src/reddit/icons/fonts/Coin/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o),r=n("./bundled-modules/styled-components/styled-components.min.js"),i=n.n(r),a=n("./src/reddit/constants/colors.ts"),d=n("./src/reddit/icons/fonts/helpers.tsx");const c=i()(e=>s.a.createElement("i",{className:`${Object(d.b)("coin")} ${e.className}`})).withConfig({componentId:"s1ln6o66-0"})(["display: inline-block;vertical-align: middle;color: ",";"],e=>e.fillColor||a.a.gold);t.a=c},"./src/reddit/icons/svgs/Help/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o);t.a=(e=>s.a.createElement("svg",{className:e.className,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{fill:"inherit",d:"M8.622 10.616c.078.08.14.175.183.28.044.105.07.218.07.332 0 .237-.087.456-.253.62-.167.168-.385.255-.622.255-.236 0-.455-.087-.62-.254-.167-.166-.255-.385-.255-.622 0-.114.027-.227.07-.332.044-.105.105-.2.184-.28.087-.088.174-.15.288-.193.324-.13.71-.052.954.193zm-.205-6.242c1.595 0 2.466.807 2.466 1.92 0 .976-.556 1.448-1.238 1.816-.615.317-.83.518-.904.898 0 .004-.034.207-.036.21-.034.126-.087.244-.18.336-.14.14-.323.21-.524.21-.097 0-.192-.017-.29-.052-.087-.035-.165-.088-.235-.158-.14-.14-.22-.333-.22-.533 0-.11.02-.188.074-.348.16-.472.55-.896 1.056-1.17.577-.327.84-.558.84-1.07 0-.42-.357-.715-.987-.715-.496 0-.996.218-1.39.52-.26.2-.62.202-.858-.02l-.05-.05c-.313-.29-.27-.787.075-1.04.603-.444 1.394-.753 2.4-.753zM8 13.25c-2.895 0-5.25-2.355-5.25-5.25S5.105 2.75 8 2.75 13.25 5.105 13.25 8 10.895 13.25 8 13.25M8 1C4.14 1 1 4.14 1 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7"})))},"./src/reddit/icons/svgs/Smile/index.tsx":function(e,t,n){"use strict";var o=n("./node_modules/react/index.js"),s=n.n(o);t.a=(e=>s.a.createElement("svg",{className:e.className,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},s.a.createElement("path",{fill:"inherit",fillRule:"evenodd",d:"M13 9.0074c-.777 0-1.406-.63-1.406-1.406 0-.777.629-1.407 1.406-1.407.777 0 1.406.63 1.406 1.407 0 .776-.629 1.406-1.406 1.406m-3 5.581c-2.206 0-4-1.57-4-3.5 0-.276.224-.5.5-.5h7c.276 0 .5.224.5.5 0 1.93-1.794 3.5-4 3.5m-3-8.394c.777 0 1.406.63 1.406 1.407 0 .776-.629 1.406-1.406 1.406-.777 0-1.406-.63-1.406-1.406 0-.777.629-1.407 1.406-1.407m3-4.194c-4.411 0-8 3.588-8 8 0 4.411 3.589 8 8 8s8-3.589 8-8c0-4.412-3.589-8-8-8"})))},"./src/reddit/layout/row/RightAlign/index.tsx":function(e,t,n){"use strict";var o=n("./bundled-modules/styled-components/styled-components.min.js"),s=n.n(o),r=n("./src/reddit/layout/row/Inline/index.tsx");t.a=s()(r.a).withConfig({componentId:"xoy62-0"})(["display: flex;margin-left: auto;"])}}]);
//# sourceMappingURL=RichTextEditor.13e00526655aa4eedfbf.js.map